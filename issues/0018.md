---
title: Daily smoke tests via GitHub Actions
status: open
---

## Context & Intent

Testing the full agent loop (session creation → LLM call → tool execution →
entry persistence → completion) is currently manual. We need a scheduled CI
job that runs a small set of smoke test scenarios against a real LLM,
catches regressions in the full stack, and opens a GitHub issue if something
breaks.

Unit tests cover the runtime internals. These smoke tests cover the
end-to-end path that unit tests can't: prompt construction, provider
integration, real tool execution, and session lifecycle.

## Tasks

- Add a GitHub Actions workflow that runs daily on a cron schedule.
- The workflow builds the server and CLI, starts the server, and runs a set
  of smoke test scripts via the CLI.
- Smoke scripts are natural language scenarios in a folder
  (e.g. `tests/smoke/`). Each describes a task, the CLI commands to run it,
  and what to verify. Start with 3-4 basics:
  - Create a file and verify it exists.
  - Run a bash command and verify output in session history.
  - Steer a running session mid-execution.
  - Use async bash and verify the callback arrives.
- If any scenario fails, the workflow opens a GitHub issue with the failure
  details.
- LLM API keys are stored as GitHub Actions secrets.

## Success Criteria

- Workflow runs daily without manual intervention.
- Failures produce a GitHub issue with enough context to diagnose.
- Passing run completes in under 10 minutes.
