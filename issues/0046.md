---
title: "Introduce WuhuMount and WuhuMountTemplate types"
status: open
assignee: agent
priority: high
parent: "0045"
---

# WUHU-0046: Introduce WuhuMount and WuhuMountTemplate types

## Summary

Define the core data types that replace the current environment abstraction.

## Types

### WuhuMountTemplate

Replaces `WuhuEnvironmentDefinition`. A recipe for producing a mount. Stored
in the server database.

```swift
public enum WuhuMountTemplateType: String {
  case folder
  // future: zfsDataset, etc.
}

public struct WuhuMountTemplate {
  var id: String
  var name: String
  var type: WuhuMountTemplateType
  var templatePath: String       // source to copy from
  var workspacesPath: String     // where to put copies
  var startupScript: String?
  var createdAt: Date
  var updatedAt: Date
}
```

### WuhuMount

Replaces `WuhuEnvironment` (session snapshot). A concrete, resolved directory
bound to a session.

```swift
public struct WuhuMount {
  var id: String                 // UUID
  var sessionID: String
  var name: String               // human label, e.g. "wuhu-core"
  var path: String               // resolved absolute path
  var mountTemplateID: String?   // which template produced this, if any
  var isPrimary: Bool            // tools default to this mount's path
  var createdAt: Date
}
```

### RunnerID

```swift
public enum RunnerID: Sendable, Hashable {
  case local
  // future: case remote(name: String)
}
```

Runner awareness is embedded in mounts from the start, but only `.local` is
implemented.

## Database

- New `mount_templates` table (replaces `environments`)
- New `mounts` table (tracks every mount created, enables future GC)
- Mounts reference sessions and optionally reference mount templates

## Migration

Data migration from `environments` â†’ `mount_templates` is handled in
WUHU-0053.
