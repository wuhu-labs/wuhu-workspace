---
title: "wuhu-core 0.5.0: Mounts, context cleanup, and tech debt"
status: done
assignee: agent
priority: critical
kind: umbrella
related: [0046, 0047, 0048, 0049, 0050, 0051, 0052, 0053, 0054]
---

# WUHU-0045: wuhu-core 0.5.0 — Mounts, context cleanup, and tech debt

## Summary

0.5.0 is a cleanup release that uses the mount abstraction as the vehicle for
paying down tech debt accumulated during the W08 rush. No new user-facing
features beyond what's needed to make the architecture honest.

## Goals

1. **Introduce the mount abstraction.** Sessions optionally have mounts
   (resolved directories). Replace the hard coupling between session and
   environment. Sessions can start mount-free (pure chat).

2. **Clean separation of system prompt vs context.** System instruction is
   just identity ("you are a coding agent"). Skills, AGENTS.md, and mount
   announcements become transcript entries, not system prompt appendages.

3. **Rename environment → mount template.** The canonical definition in the
   DB is a recipe for producing a mount, not an "environment."

4. **Runner abstraction (in-process only).** Define `RunnerID` and a runner
   protocol. All tool execution goes through a runner, but for 0.5.0 the
   only implementation is local/in-process. Drop the WebSocket runner code.

5. **Drop channels.** Remove `WuhuSessionType.channel`, `.forkedChannel`,
   and all associated code. Will be redesigned later.

6. **Trim tool surface.** Remove `swift` tool. Reduce env CRUD tools.
   Target ~12 tools down from 21.

7. **Testing harness.** In-memory service test harness with mock LLM. Test
   resume-after-restart, compaction, and the full create → enqueue → execute
   → result flow.

8. **Database migration.** Clean migration from 0.4.0 schema to 0.5.0.

## Sub-issues

| Issue | Title |
|-------|-------|
| WUHU-0046 | Introduce WuhuMount and WuhuMountTemplate types |
| WUHU-0047 | Make session environment optional, support mount-free sessions |
| WUHU-0048 | Move skills and AGENTS.md from system prompt to transcript entries |
| WUHU-0049 | Runner abstraction with RunnerID and in-process LocalRunner |
| WUHU-0050 | Drop channel session types and related code |
| WUHU-0051 | Trim tool surface (drop swift tool, reduce env CRUD) |
| WUHU-0052 | In-memory WuhuService test harness with mock LLM |
| WUHU-0053 | Database migration from 0.4.0 to 0.5.0 schema |
| WUHU-0054 | Verify and test compaction end-to-end |

## Non-goals for 0.5.0

- Multiple mounts per session (data model supports it, but tools assume one)
- JS repl / QuickJS / Deno
- `wuhu://` URL scheme
- Remote runners
- Channel redesign
- GC for old mount directories
