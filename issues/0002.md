---
title: Allow change the model mid-session
status: closed
---

Expand both wuhu client CLI and iOS app to support change model mid-session. In
the iOS app, the model picker should be the same we used for model picker in
session creation. The arguments for CLI should also be identical to the
arguments for session creation.

This change should only take effect when a model has finished processing and is
idle.

What is finished processing? When we do LLM processing, we send a request, it
comes back with one or more message parts, could be mixed of text, reasoning,
and tool call. When the model's output does not contain any tool call, it is
considered finished. That's when new model selection should take effect.

I need you to think about how to do this, leaving space for future features.
Among other things, we will need to support queue messages, in both steer and
follow up mode (see pi-mono's coding agent to understand this). Think how this
change could interact with future support for message queues.

To support validation, I need you to ship a log mode for this app. It should
dump the initial request and final response, of all LLM requests, to a folder,
ordered by time. That should prove that we indeed switched model. You need to
drive wuhu client cli manually and see if the model switching behavior is indeed
correct.
